.global main_rot13   
.data
.align 2
string_anterior: .space 100
.align 2
imagen_actual_rot: .byte 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
.align 2
input_rot: .space 100
.align 2
string_rot: .space 100
.align 2
puntero_string: .space 4
.align 2
puntero_input: .space 4
.align 2
msg_entrada_rot: .asciiz "entrada:"
.align 2
msg_salida_rot: .asciiz "salida:"
.align 2
msg_titulo_rot: .asciiz "rot13"
.align 2
untero_input: .space 4
.align 2
renglon_1_rot: .word 0
renglon_2_rot: .word 0
renglon_3_rot: .word 0
renglon_4_rot: .word 0
renglon_5_rot: .word 0
renglon_6_rot: .word 0
renglon_7_rot: .word 0
renglon_8_rot: .word 0

.text
#	Leo el mensaje que se desea encriptar
main_rot13:
    # Cuido el STACK
    addiu $sp, $sp, -8
    sw $ra, ($sp)
    sw $s0, 4($sp)
    # ---------------
    # Limpio la pantalla
    la $a0, imagen_actual_rot
    jal cargar_imagen
    #------------

    # Cargo las direcciones de memoria de los renglones
    la $t0, imagen_actual_rot
    sw $t0, renglon_1_rot
    
    la $t1, renglon_1_rot
    
    addi $t0, $t0, 128
    sw $t0, renglon_2_rot
    
    addi $t0, $t0, 128
    sw $t0, renglon_3_rot

    addi $t0, $t0, 128
    sw $t0, renglon_4_rot

    addi $t0, $t0, 128
    sw $t0, renglon_5_rot

    addi $t0, $t0, 128
    sw $t0, renglon_6_rot

    addi $t0, $t0, 128
    sw $t0, renglon_7_rot

    addi $t0, $t0, 128
    sw $t0, renglon_8_rot
    # ---------------

    # Cargo el titulo
    la $a0, msg_titulo_rot
    la $a1, renglon_1_rot
    li $a2, 5
    la $a3, imagen_actual_rot
    jal imprimir_texto

    # Cargo el texto de la entrada
    la $a0, msg_entrada_rot
    la $a1, renglon_2_rot
    li $a2, 8
    la $a3, imagen_actual_rot
    jal imprimir_texto

    # Cargo el texto de la entrada
    la $a0, msg_salida_rot
    la $a1, renglon_5_rot
    li $a2, 7
    la $a3, imagen_actual_rot
    jal imprimir_texto

    loop_main_rot13:
        la $s0, input_rot
        la $t0, string_rot
        sw $t0, puntero_string
        loop_leer_nuevo_caracter:
            # Leo una primera entrada en modo lectura normal
            li $a0, 0
            jal leer_teclado
            jal esperar_debounce
            beq $v0, 'd', encriptar_rot13
            beq $v0, 'a', fin_rot13
            sb $v0, ($s0)
            jal procesar_entrada_rot13
            jal imprimir_string_rot
            addi $s0, $s0, 1

        # Leo otra vez, teniendo en cuenta el tiempo
        # Si me ingresan un caracter igual al anterior lo guardo
        # Si pasa el tiempo guardo un guion
        # Si me ingresan un caracter distinto guardo un guion y el caracter nuevo
        loop_repetido:
            li $a0, 1
            jal leer_teclado
	    jal esperar_debounce
            beq $v0, 'd', encriptar_rot13
            beq $v0, 'a', fin_rot13
            lb $t1, -1($s0)
            bne $v0, $t1, guardar_caracter
            beq $v0, '-', guardo_guion_y_nueva_entrada 
            sb $v0, ($s0)
            addi $s0, $s0, 1
            jal procesar_entrada_rot13
            jal imprimir_string_rot
            j loop_repetido

    guardo_guion_y_nueva_entrada:
        li $t1, '-'
        sb $t1, ($s0)
        addi $s0, $s0, 1
        jal procesar_entrada_rot13
        jal imprimir_string_rot
        j loop_leer_nuevo_caracter

    guardar_caracter:
        li $t1, '-'
        sb $t1, ($s0)
        addi $s0, $s0, 1
        sb $v0, ($s0)
        addi $s0, $s0, 1
        jal procesar_entrada_rot13
        jal imprimir_string_rot
        j loop_repetido
	
fin_rot13:
    # Limpiar el input y el string

    # Devuelvo el STACK
    lw $ra, ($sp)
    lw $s0, 4($sp)
    addiu $sp, $sp, 8
    # ---------------
    jr $ra

# -------------------------------------------------------------------------------
procesar_entrada_rot13:
    # Cuido el STACK
    addiu $sp, $sp, -12
    sw $ra, ($sp)
    sw $s0, 4($sp)
    sw $s2, 8($sp)
    # ---------------
    la $s0, input_rot
    loop_procesar_entrada_rot13:
        lb $s2, ($s0)
        beq $s2, 0, fin_procesar_entrada_rot13 # terminó la cadena
        beq $s2, '#', eliminar_ultimo_caracter
        li $t1, 0 # contador de apariciones de el mismo caracter en la secuencia
        lb $a0, ($s0)
        # Itera hasta encontrar '-' y cuenta en $t1 cuntas veces aparecio el caracter
        loop_secuencia_interna:
            beq $s2,'-',fin_secuencia
	    beq $s2, 0, fin_total_secuencia
            addi $t1, $t1, 1
            addi $s0, $s0, 1
	    lb $s2, ($s0)
        j loop_secuencia_interna
        fin_secuencia:
            addi $s0,$s0,1
	    fin_total_secuencia:
            move $a1, $t1
	    beq $a0, '-', loop_procesar_entrada_rot13
            jal procesar_caracter
            move $a0, $v0
            jal agregar_a_string_rot
            j loop_procesar_entrada_rot13
    
    # Elimina el último caracter ingresado en string_rot
    # Usa $t3 (puntero a string_rot)
    eliminar_ultimo_caracter:
        la $t4, string_rot
        la $t3, puntero_string
        addi $t3, $t3, -1
        blt $t3, $t4, fin_eliminar_ultimo_caracter
        sb $0, ($t3)
        sw $t3, puntero_string
        fin_eliminar_ultimo_caracter:
            addi $t0, $t0, 1
            j loop_procesar_entrada_rot13

    fin_procesar_entrada_rot13:
        # Devuelvo el STACK
        lw $ra, ($sp)
        lw $s0, 4($sp)
        lw $s2, 8($sp)
        addiu $sp, $sp, 12
        # ---------------
        jr $ra
# -------------------------------------------------------------------------------

imprimir_string_rot:
    # Cuido el STACK
    addiu $sp, $sp, -4
    sw $ra, ($sp)
    # ---------------
    # Limpio el renglon 3
    lw $a0, renglon_3_rot
    jal limpiar_renglon
    #----------
    la $a0, string_rot
    la $a1, renglon_3_rot
    jal largo_string
    move $a2, $v0
    la $a3, imagen_actual_rot
    jal imprimir_texto
    # Limpio la memoria de string_rot
    jal copiar_a_anterior
    jal limpiar_string
    #----------
    # Devuelvo el STACK
    lw $ra, ($sp)
    addiu $sp, $sp, 4
    # ---------------
    jr $ra

copiar_a_anterior:
    la $t0, string_rot
    la $t1, string_anterior
    loop_copiar_a_anterior:
        lb $t2, ($t0)
        beq $t2, 0, fin_copiar_a_anterior
        sb $t2, ($t1)
        addi $t0, $t0, 1
        addi $t1, $t1, 1
        j loop_copiar_a_anterior
    fin_copiar_a_anterior:
        jr $ra


# En $a0 el puntero al renglon que hay que limpiar 
limpiar_renglon:
    # Cuide el stack
    addiu $sp, $sp, -4
    sw $ra, ($sp)
    # ---------------
    li $t0, 0
    loop_limpiar_renglon:
        sb $0, ($a0)
        addi $a0, $a0, 1
        addi $t0, $t0, 1
        beq $t0, 128, fin_limpiar_renglon
        j loop_limpiar_renglon
    fin_limpiar_renglon:
        la $a0, imagen_actual_rot
        jal cargar_imagen
    # Devuelvo el stack
    lw $ra, ($sp)
    addiu $sp, $sp, 4
    # ---------------
    jr $ra

agregar_a_string_rot:
    lw $t0, puntero_string
    sb $a0, ($t0)
    addi $t0, $t0, 1
    sw $t0, puntero_string
    jr $ra

limpiar_string:
    la $t0, string_rot
    loop_limpiar_string:
        lb $t1, ($t0)
        beq $t1, 0, fin_limpiar_string
        sb $0, ($t0)
        addi $t0, $t0, 1
        j loop_limpiar_string
    fin_limpiar_string:
        la $t0, string_rot
        sw $t0, puntero_string
        jr $ra


# Le paso en $a0 el numero del caracter y en $a1 el numero de veces que se repite ese numero.
# Guarda en string_rot el caracter correspondiente a la secuencia leida de input_rot
    procesar_caracter:
        # Cuido el STACK
        addiu $sp, $sp, -4
        sw $ra, ($sp)
        # ---------------
        beq $a0, '0', familia_0
        beq $a0, '1', familia_1
        beq $a0, '2', familia_2
        beq $a0, '3', familia_3
        beq $a0, '4', familia_4
        beq $a0, '5', familia_5
        beq $a0, '6', familia_6
        beq $a0, '7', familia_7
        beq $a0, '8', familia_8
        beq $a0, '9', familia_9

        familia_0:
            blt $a1, 3, seguir_familia_0
            jal normalizar_a_2
            move $a1, $v0
            seguir_familia_0:
            beq $a1, 1, caracter_0
            beq $a1, 2, caracter_espacio

        familia_1:
            blt $a1, 5, seguir_familia_1
            jal normalizar_a_4
            move $a1, $v0
            seguir_familia_1:
            beq $a1, 1, caracter_1
            beq $a1, 2, caracter_coma
            beq $a1, 3, caracter_punto
            beq $a1, 4, caracter_exclamacion

        familia_2:
            blt $a1, 5, seguir_familia_2
            jal normalizar_a_4
            move $a1, $v0
            move $a1, $v0
            seguir_familia_2:
            beq $a1, 1, caracter_a
            beq $a1, 2, caracter_b
            beq $a1, 3, caracter_c
            beq $a1, 4, caracter_2

        familia_3:
            blt $a1, 5, seguir_familia_3
            jal normalizar_a_4
            move $a1, $v0
            seguir_familia_3:
            beq $a1, 1, caracter_d
            beq $a1, 2, caracter_e
            beq $a1, 3, caracter_f
            beq $a1, 4, caracter_3
        
        familia_4:
            blt $a1, 5, seguir_familia_4
            jal normalizar_a_4
            move $a1, $v0
            seguir_familia_4:
            beq $a1, 1, caracter_g
            beq $a1, 2, caracter_h
            beq $a1, 3, caracter_i
            beq $a1, 4, caracter_4
        
        familia_5:
            blt $a1, 5, seguir_familia_5
            jal normalizar_a_4
            move $a1, $v0
            seguir_familia_5:
            beq $a1, 1, caracter_j
            beq $a1, 2, caracter_k
            beq $a1, 3, caracter_l
            beq $a1, 4, caracter_5
        
        familia_6:
            blt $a1, 5, seguir_familia_6
            jal normalizar_a_4
            move $a1, $v0
            seguir_familia_6:
            beq $a1, 1, caracter_m
            beq $a1, 2, caracter_n
            beq $a1, 3, caracter_o
            beq $a1, 4, caracter_6

        familia_7:
            blt $a1, 6, seguir_familia_7
            jal normalizar_a_5
            move $a1, $v0
            seguir_familia_7:
            beq $a1, 1, caracter_p
            beq $a1, 2, caracter_q
            beq $a1, 3, caracter_r
            beq $a1, 4, caracter_s
            beq $a1, 5, caracter_7
        
        familia_8:
            blt $a1, 5, seguir_familia_8
            jal normalizar_a_4
            move $a1, $v0
            seguir_familia_8:
            beq $a1, 1, caracter_t
            beq $a1, 2, caracter_u
            beq $a1, 3, caracter_v
            beq $a1, 4, caracter_8
        
        familia_9:
            blt $a1, 6, seguir_familia_9
            jal normalizar_a_5
            move $a1, $v0
            seguir_familia_9:
            beq $a1, 1, caracter_w
            beq $a1, 2, caracter_x
            beq $a1, 3, caracter_y
            beq $a1, 4, caracter_z
            beq $a1, 5, caracter_9

        caracter_a:
            li $v0, 'a'
            j fin_procesar_caracter
        
        caracter_b:
            li $v0, 'b'
            j fin_procesar_caracter
        
        caracter_c:
            li $v0, 'c'
            j fin_procesar_caracter
        
        caracter_d:
            li $v0, 'd'
            j fin_procesar_caracter

        caracter_e:
            li $v0, 'e'
            j fin_procesar_caracter
        
        caracter_f:
            li $v0, 'f'
            j fin_procesar_caracter

        caracter_g:
            li $v0, 'g'
            j fin_procesar_caracter

        caracter_h:
            li $v0, 'h'
            j fin_procesar_caracter

        caracter_i:
            li $v0, 'i'
            j fin_procesar_caracter

        caracter_j:
            li $v0, 'j'
            j fin_procesar_caracter

        caracter_k:
            li $v0, 'k'
            j fin_procesar_caracter

        caracter_l:
            li $v0, 'l'
            j fin_procesar_caracter

        caracter_m:
            li $v0, 'm'
            j fin_procesar_caracter

        caracter_n:
            li $v0, 'n'
            j fin_procesar_caracter

        caracter_o:
            li $v0, 'o'
            j fin_procesar_caracter

        caracter_p:
            li $v0, 'p'
            j fin_procesar_caracter

        caracter_q:
            li $v0, 'q'
            j fin_procesar_caracter

        caracter_r:
            li $v0, 'r'
            j fin_procesar_caracter

        caracter_s:
            li $v0, 's'
            j fin_procesar_caracter

        caracter_t:
            li $v0, 't'
            j fin_procesar_caracter

        caracter_u:
            li $v0, 'u'
            j fin_procesar_caracter

        caracter_v:
            li $v0, 'v'
            j fin_procesar_caracter

        caracter_w:
            li $v0, 'w'
            j fin_procesar_caracter

        caracter_x:
            li $v0, 'x'
            j fin_procesar_caracter  

        caracter_y:
            li $v0, 'y'
            j fin_procesar_caracter
        
        caracter_z:
            li $v0, 'z'
            j fin_procesar_caracter

        caracter_0:
            li $t1, '0'
            j fin_procesar_caracter
        
        caracter_1:
            li $v0, '1'
            j fin_procesar_caracter
        
        caracter_2:
            li $v0, '2'
            j fin_procesar_caracter
        
        caracter_3:
            li $t1, '3'
            j fin_procesar_caracter
        
        caracter_4:
            li $v0, '4'
            j fin_procesar_caracter
        
        caracter_5:
            li $v0, '5'
            j fin_procesar_caracter
        
        caracter_6:
            li $v0, '6'
            j fin_procesar_caracter
        
        caracter_7:
            li $v0, '7'
            j fin_procesar_caracter
        
        caracter_8:
            li $v0, '8'
            j fin_procesar_caracter

        caracter_9:
            li $v0, '9'
            j fin_procesar_caracter
        
        caracter_espacio:
            li $v0, ' '
            j fin_procesar_caracter
        
        caracter_coma:            
            li $v0, ','
            j fin_procesar_caracter
        
        caracter_punto: 
            li $v0, '.'
            j fin_procesar_caracter
        
        caracter_exclamacion:
            li $v0, '!'
            j fin_procesar_caracter

        fin_procesar_caracter:
            # Devuelvo el STACK
            lw $ra, ($sp)
            addiu $sp, $sp, 4
            # ---------------
            jr $ra

# Funcion normalizar, recibe en $a1 el contador y lo normaliza a 4 o 5 y devuelve en $v0 el valor normalizado
        normalizar_a_4:
            blt $a1, 5, fin_normalizar           
            addi $a1, $a1, -4
            j normalizar_a_4
        
        normalizar_a_5:
            blt $a1, 6, fin_normalizar
            addi $a1, $a1, -5
            j normalizar_a_5

        normalizar_a_2:
            blt $a1, 3, fin_normalizar
            addi $a1, $a1, -2
            j normalizar_a_2
        
	fin_normalizar:
            move $v0, $a1
            jr $ra

# FUNCION ENCRIPTACION ROT13

encriptar_rot13:
    la $t0, string_anterior  # Cargar la dirección del String en $t0
    loop_encriptar:
        lb $t1, ($t0)       # Cargar un byte del String en $t1
    
        # Verificar si el byte es una letra y convertirla según corresponda
        beq $t1, 0, fin	# Si el byte es 0 quiere decir que llegamos al final, terminamos el bucle y mostramos mensaje de salida.
        bgt $t1, 122, proximo #Si el byte es mayor a 122 quiere decir que no es ninguna letra, lo mismo pasa si es menor a 65.
        blt $t1, 65, proximo
        bge $t1, 97, minusculas

    proximo:
        addi $t0, $t0, 1     # Avanzo al siguiente byte
        j loop_encriptar

    minusculas:
        addi $t1, $t1, 13    # Avanzo 13 posiciones en el alfabeto
        bgt $t1, 122, ajustar #Si el valor obtenido luego de avanzar es mayor al límite debo ajustarlo
        sb $t1, ($t0)        # Almaceno el byte resultante
        j proximo

    ajustar:
        addi $t1, $t1, -26   # Ajusto hacia atrás en caso de exceso, con módulo 26
        sb $t1, 0($t0)       # Almaceno el byte resultante
        j proximo

fin:
    # Cargo el texto codificado en el renglon 8
    la $a0, string_anterior
    la $a1, renglon_8_rot
    jal largo_string
    move $a2, $v0
    la $a3, imagen_actual_rot
    jal imprimir_texto
    #-------------------
    # Limpio el input
    la $t0, input_rot
    li $t1, 0
    loop_limpiar_input:
        sb $0, ($t0)
        addi $t0, $t0, 1
        lb $t2, ($t0)
        bne $t2, 0, loop_limpiar_input
    #-------------------

    # Limpio el string
    jal limpiar_string
    #-------------------

    # Limpio el string anterior
    la $t0, string_anterior
    loop_limpiar_string_anterior:
        sb $0, ($t0)
        addi $t0, $t0, 1
        lb $t2, ($t0)
        bne $t2, 0, loop_limpiar_string_anterior
    #-------------------
    j loop_main_rot13




